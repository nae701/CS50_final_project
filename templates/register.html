{% extends "layout.html" %}

{% block title %}
    Register
{% endblock %}

{% block main %}
    <form id="register_form" action="/register" method="post">
        <div class="form-group">
            <input autocomplete="off" autofocus class="form-control" name="username" placeholder="Username" type="text">
        </div>
        <div class="form-group">
            <input class="form-control" name="password" placeholder="Password" type="password">
        </div>
        <div class="form-group">
            <input class="form-control" name="confirmation" placeholder="Confirm Password" type="password">
        </div>
        <button class="btn btn-primary" type="submit">Register</button>
    </form>
    <script>
         document.querySelector("form").addEventListener('submit', function(event) {
             event.preventDefault();
             $.get("/check", {username: $('[name="username"]')[0].value}, function(data) {
                 if(data) {
                     $('#register_form').submit();
                     return true;
                 } else {
                     alert("That username is already taken!");
                     return false;
                 }
             })
         })
    </script>
{% endblock %}
